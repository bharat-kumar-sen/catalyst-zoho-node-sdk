"use strict";(self.webpackChunkangular_app=self.webpackChunkangular_app||[]).push([[435],{5435:(G,v,c)=>{c.r(v),c.d(v,{LoginModule:()=>Z});var _=c(6814),d=c(593);class P{constructor(){this.email="admin@admin.com",this.password="Admin@123",this.remember=!0}}var p=c(7775),m=c(553),o=c(4769),w=c(2425),k=c(8672),O=c(5861),R=c(5619),I=c(8645),U=c(4552);class E extends I.x{constructor(a=1/0,e=1/0,t=U.l){super(),this._bufferSize=a,this._windowTime=e,this._timestampProvider=t,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,a),this._windowTime=Math.max(1,e)}next(a){const{isStopped:e,_buffer:t,_infiniteTimeWindow:i,_timestampProvider:n,_windowTime:r}=this;e||(t.push(a),!i&&t.push(n.now()+r)),this._trimBuffer(),super.next(a)}_subscribe(a){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(a),{_infiniteTimeWindow:t,_buffer:i}=this,n=i.slice();for(let r=0;r<n.length&&!a.closed;r+=t?1:2)a.next(n[r]);return this._checkFinalizedStatuses(a),e}_trimBuffer(){const{_bufferSize:a,_timestampProvider:e,_buffer:t,_infiniteTimeWindow:i}=this,n=(i?1:2)*a;if(a<1/0&&n<t.length&&t.splice(0,t.length-n),!i){const r=e.now();let l=0;for(let u=1;u<t.length&&t[u]<=r;u+=2)l=u;l&&t.splice(0,l+1)}}}class L extends I.x{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(a){const{hasError:e,_hasValue:t,_value:i,thrownError:n,isStopped:r,_isComplete:l}=this;e?a.error(n):(r||l)&&(t&&a.next(i),a.complete())}next(a){this.isStopped||(this._value=a,this._hasValue=!0)}complete(){const{_hasValue:a,_value:e,_isComplete:t}=this;t||(this._isComplete=!0,a&&super.next(e),super.complete())}}var D=c(2664),T=c(2181);function b(s){return(0,T.h)((a,e)=>s<=e)}var S=c(8180);class N{constructor(){}loadScript(a,e,t,i=null){if(typeof document<"u"&&!document.getElementById(a)){let n=document.createElement("script");n.async=!0,n.src=e,n.onload=t,i||(i=document.head),i.appendChild(n)}}}class A{}const j={oneTapEnabled:!0};let g=(()=>{class s extends N{static#e=this.PROVIDER_ID="GOOGLE";constructor(e,t){super(),this.clientId=e,this.initOptions=t,this.changeUser=new o.vpe,this._socialUser=new R.X(null),this._accessToken=new R.X(null),this._receivedAccessToken=new o.vpe,this.initOptions={...j,...this.initOptions},this._socialUser.pipe(b(1)).subscribe(this.changeUser),this._accessToken.pipe(b(1)).subscribe(this._receivedAccessToken)}initialize(e){return new Promise((t,i)=>{try{this.loadScript(s.PROVIDER_ID,"https://accounts.google.com/gsi/client",()=>{if(google.accounts.id.initialize({client_id:this.clientId,auto_select:e,callback:({credential:n})=>{const r=this.createSocialUser(n);this._socialUser.next(r)},prompt_parent_id:this.initOptions?.prompt_parent_id,itp_support:this.initOptions.oneTapEnabled}),this.initOptions.oneTapEnabled&&this._socialUser.pipe((0,T.h)(n=>null===n)).subscribe(()=>google.accounts.id.prompt(console.debug)),this.initOptions.scopes){const n=this.initOptions.scopes instanceof Array?this.initOptions.scopes.filter(r=>r).join(" "):this.initOptions.scopes;this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.clientId,scope:n,prompt:this.initOptions.prompt,callback:r=>{r.error?this._accessToken.error({code:r.error,description:r.error_description,uri:r.error_uri}):this._accessToken.next(r.access_token)}})}t()})}catch(n){i(n)}})}getLoginStatus(){return new Promise((e,t)=>{this._socialUser.value?e(this._socialUser.value):t(`No user is currently logged in with ${s.PROVIDER_ID}`)})}refreshToken(){return new Promise((e,t)=>{google.accounts.id.revoke(this._socialUser.value.id,i=>{i.error?t(i.error):e(this._socialUser.value)})})}getAccessToken(){return new Promise((e,t)=>{this._tokenClient?(this._tokenClient.requestAccessToken({hint:this._socialUser.value?.email}),this._receivedAccessToken.pipe((0,S.q)(1)).subscribe(e)):t(this._socialUser.value?"No token client was instantiated, you should specify some scopes.":"You should be logged-in first.")})}revokeAccessToken(){return new Promise((e,t)=>{this._tokenClient?this._accessToken.value?google.accounts.oauth2.revoke(this._accessToken.value,()=>{this._accessToken.next(null),e()}):t("No access token to revoke"):t("No token client was instantiated, you should specify some scopes.")})}signIn(){return Promise.reject('You should not call this method directly for Google, use "<asl-google-signin-button>" wrapper or generate the button yourself with "google.accounts.id.renderButton()" (https://developers.google.com/identity/gsi/web/guides/display-button#javascript)')}signOut(){var e=this;return(0,O.Z)(function*(){google.accounts.id.disableAutoSelect(),e._socialUser.next(null)})()}createSocialUser(e){const t=new A;t.idToken=e;const i=this.decodeJwt(e);return t.id=i.sub,t.name=i.name,t.email=i.email,t.photoUrl=i.picture,t.firstName=i.given_name,t.lastName=i.family_name,t}decodeJwt(e){const i=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(window.atob(i).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(n)}}return s})(),f=(()=>{class s{static#e=this.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found";static#t=this.ERR_NOT_LOGGED_IN="Not logged in";static#i=this.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?";static#s=this.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token";static#o=this.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN="Chosen login provider is not supported for getting an access token";get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}constructor(e,t,i){this._ngZone=t,this._injector=i,this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new E(1),this.initialized=!1,this._initState=new L,e instanceof Promise?e.then(n=>{this.initialize(n)}):this.initialize(e)}initialize(e){this.autoLogin=void 0!==e.autoLogin&&e.autoLogin;const{onError:t=console.error}=e;e.providers.forEach(i=>{this.providers.set(i.id,"prototype"in i.provider?this._injector.get(i.provider):i.provider)}),Promise.all(Array.from(this.providers.values()).map(i=>i.initialize(this.autoLogin))).then(()=>{if(this.autoLogin){const i=[];let n=!1;this.providers.forEach((r,l)=>{const u=r.getLoginStatus();i.push(u),u.then(y=>{this.setUser(y,l),n=!0}).catch(console.debug)}),Promise.all(i).catch(()=>{n||(this._user=null,this._authState.next(null))})}this.providers.forEach((i,n)=>{(0,D.b)(i.changeUser)&&i.changeUser.subscribe(r=>{this._ngZone.run(()=>{this.setUser(r,n)})})})}).catch(i=>{t(i)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}getAccessToken(e){var t=this;return(0,O.Z)(function*(){const i=t.providers.get(e);if(!t.initialized)throw s.ERR_NOT_INITIALIZED;if(!i)throw s.ERR_LOGIN_PROVIDER_NOT_FOUND;if(!(i instanceof g))throw s.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN;return yield i.getAccessToken()})()}refreshAuthToken(e){return new Promise((t,i)=>{if(this.initialized){const n=this.providers.get(e);n?"function"!=typeof n.refreshToken?i(s.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN):n.refreshToken().then(r=>{this.setUser(r,e),t()}).catch(r=>{i(r)}):i(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(s.ERR_NOT_INITIALIZED)})}refreshAccessToken(e){return new Promise((t,i)=>{if(this.initialized)if(e!==g.PROVIDER_ID)i(s.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const n=this.providers.get(e);n instanceof g?n.revokeAccessToken().then(t).catch(i):i(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(s.ERR_NOT_INITIALIZED)})}signIn(e,t){return new Promise((i,n)=>{if(this.initialized){let r=this.providers.get(e);r?r.signIn(t).then(l=>{this.setUser(l,e),i(l)}).catch(l=>{n(l)}):n(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else n(s.ERR_NOT_INITIALIZED)})}signOut(e=!1){return new Promise((t,i)=>{if(this.initialized)if(this._user){let r=this.providers.get(this._user.provider);r?r.signOut(e).then(()=>{t(),this.setUser(null)}).catch(l=>{i(l)}):i(s.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(s.ERR_NOT_LOGGED_IN);else i(s.ERR_NOT_INITIALIZED)})}setUser(e,t){e&&t&&(e.provider=t),this._user=e,this._authState.next(e)}static#n=this.\u0275fac=function(t){return new(t||s)(o.LFG("SocialAuthServiceConfig"),o.LFG(o.R0b),o.LFG(o.zs3))};static#r=this.\u0275prov=o.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),C=(()=>{class s{static initialize(e){return{ngModule:s,providers:[f,{provide:"SocialAuthServiceConfig",useValue:e}]}}constructor(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}static#e=this.\u0275fac=function(t){return new(t||s)(o.LFG(s,12))};static#t=this.\u0275mod=o.oAB({type:s});static#i=this.\u0275inj=o.cJS({providers:[f],imports:[_.ez]})}return s})(),M=(()=>{class s{static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275mod=o.oAB({type:s});static#i=this.\u0275inj=o.cJS({})}return s})();var h=c(95);const x=function(){return["/dashboard"]},F=[{path:"",component:(()=>{class s{constructor(e,t,i,n,r,l,u){this.router=e,this.toastr=t,this.jwtService=i,this.spinner=n,this.usersService=r,this.globalService=l,this.socialAuthService=u,this.loginObject=new P,this.currentUser=new p.ar}ngOnInit(){this.currentUser=this.jwtService.getCurrentUser(),this.currentUser&&this.router.navigate(["/dashboard"]);let e=this.jwtService.getCookie(m.N.cookieToken);e&&(this.loginObject=e)}doLogin(){let e=this.loginObject;e.remember?this.jwtService.setCookie(m.N.cookieToken,e):this.jwtService.deleteCookie(m.N.cookieToken);let t=Object.assign({},e);delete t.remember,this.spinner.show(),this.usersService.doSignIn(t).subscribe(i=>{if(this.spinner.hide(),200==i.status){let n=i.data;n.sesionStartTime=new Date,this.toastr.success(i.message,"Success"),this.jwtService.saveToken(n.authorization),this.jwtService.saveCurrentUser(JSON.stringify(n)),this.jwtService.getCurrentUser(),n&&n.role?(this.router.navigate(["/dashboard"]),this.globalService.sendActionChildToParent("")):this.router.navigate(["/login"])}else this.toastr.error(i.message,"Error")},i=>{this.spinner.hide(),this.globalService.sendActionChildToParent(""),this.toastr.error(i.message,"Error")})}static#e=this.\u0275fac=function(t){return new(t||s)(o.Y36(d.F0),o.Y36(w._W),o.Y36(p.Tj),o.Y36(k.t2),o.Y36(p.fz),o.Y36(p.Uh),o.Y36(f))};static#t=this.\u0275cmp=o.Xpm({type:s,selectors:[["app-login"]],decls:31,vars:5,consts:[[1,"row","pt-5"],[1,"col-xl-4","col-lg-5","col-md-12","d-flex","flex-column","card","m-auto"],[1,"card","card-plain"],[1,"sidenav-header","text-center","pt-4"],["aria-hidden","true","id","iconSidenav",1,"fas","fa-times","p-3","cursor-pointer","text-secondary","opacity-5","position-absolute","end-0","top-0","d-none","d-xl-none"],[1,"navbar-brand","m-0",3,"routerLink"],["src","assets/img/logo-ct-dark.png","alt","main_logo",1,"navbar-brand-img","h-100"],[1,"ms-1","font-weight-bold"],[1,"card-header","pb-0","text-start"],[1,"font-weight-bolder"],[1,"mb-0"],[1,"card-body"],["role","form"],[1,"mb-3"],["required","","type","email","name","email","placeholder","Email","aria-label","Email",1,"form-control","form-control-lg",3,"ngModel","ngModelChange"],["required","","type","password","name","password","placeholder","Password","aria-label","Password",1,"form-control","form-control-lg",3,"ngModel","ngModelChange"],[1,"form-check","form-switch"],["name","remember","checked","","type","checkbox","id","rememberMe",1,"form-check-input",3,"ngModel","ngModelChange"],["for","rememberMe",1,"form-check-label"],[1,"row","pt-3"],[1,"col-md-12","d-flex","justify-content-center"],["type","button",1,"btn","btn-primary",2,"width","200px",3,"click"]],template:function(t,i){1&t&&(o._UZ(0,"br")(1,"br")(2,"br"),o.TgZ(3,"div",0)(4,"div",1)(5,"div",2)(6,"div",3),o._UZ(7,"i",4),o.TgZ(8,"a",5),o._UZ(9,"img",6),o.TgZ(10,"b",7),o._uU(11,"CATALYST ZOHO"),o.qZA()()(),o.TgZ(12,"div",8)(13,"h4",9),o._uU(14,"Sign In"),o.qZA(),o.TgZ(15,"p",10),o._uU(16,"Enter your email and password to sign in"),o.qZA()(),o.TgZ(17,"div",11)(18,"form",12)(19,"div",13)(20,"input",14),o.NdJ("ngModelChange",function(r){return i.loginObject.email=r}),o.qZA()(),o.TgZ(21,"div",13)(22,"input",15),o.NdJ("ngModelChange",function(r){return i.loginObject.password=r}),o.qZA()(),o.TgZ(23,"div",16)(24,"input",17),o.NdJ("ngModelChange",function(r){return i.loginObject.remember=r}),o.qZA(),o.TgZ(25,"label",18),o._uU(26,"Remember me"),o.qZA()(),o.TgZ(27,"div",19)(28,"div",20)(29,"button",21),o.NdJ("click",function(){return i.doLogin()}),o._uU(30," Sign in "),o.qZA()()()()()()()()),2&t&&(o.xp6(8),o.Q6J("routerLink",o.DdM(4,x)),o.xp6(12),o.Q6J("ngModel",i.loginObject.email),o.xp6(2),o.Q6J("ngModel",i.loginObject.password),o.xp6(2),o.Q6J("ngModel",i.loginObject.remember))},dependencies:[d.rH,h._Y,h.Fj,h.Wl,h.JJ,h.JL,h.Q7,h.On,h.F]})}return s})(),pathMatch:"full"}];let V=(()=>{class s{static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275mod=o.oAB({type:s});static#i=this.\u0275inj=o.cJS({imports:[d.Bz.forChild(F),d.Bz]})}return s})();const B={oneTapEnabled:!1};let Z=(()=>{class s{static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275mod=o.oAB({type:s});static#i=this.\u0275inj=o.cJS({providers:[{provide:"SocialAuthServiceConfig",useValue:{autoLogin:!1,providers:[{id:g.PROVIDER_ID,provider:new g("1051803384347-91967jipju1ume5ul4dcr5g84bfaja56.apps.googleusercontent.com",B)}],onError:e=>{console.error(e)}}}],imports:[_.ez,d.Bz,p.eY,C,V,M]})}return s})()}}]);