"use strict";(self.webpackChunkangular_app=self.webpackChunkangular_app||[]).push([[435],{5435:(Z,v,c)=>{c.r(v),c.d(v,{LoginModule:()=>B});var _=c(6814),g=c(593);class P{constructor(){this.email="admin@admin.com",this.password="Admin@123",this.remember=!0}}var d=c(1734),m=c(553),n=c(4769),w=c(2425),k=c(8672),O=c(5861),R=c(5619),I=c(8645),U=c(4552);class E extends I.x{constructor(a=1/0,e=1/0,t=U.l){super(),this._bufferSize=a,this._windowTime=e,this._timestampProvider=t,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,a),this._windowTime=Math.max(1,e)}next(a){const{isStopped:e,_buffer:t,_infiniteTimeWindow:s,_timestampProvider:o,_windowTime:r}=this;e||(t.push(a),!s&&t.push(o.now()+r)),this._trimBuffer(),super.next(a)}_subscribe(a){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(a),{_infiniteTimeWindow:t,_buffer:s}=this,o=s.slice();for(let r=0;r<o.length&&!a.closed;r+=t?1:2)a.next(o[r]);return this._checkFinalizedStatuses(a),e}_trimBuffer(){const{_bufferSize:a,_timestampProvider:e,_buffer:t,_infiniteTimeWindow:s}=this,o=(s?1:2)*a;if(a<1/0&&o<t.length&&t.splice(0,t.length-o),!s){const r=e.now();let l=0;for(let u=1;u<t.length&&t[u]<=r;u+=2)l=u;l&&t.splice(0,l+1)}}}class L extends I.x{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(a){const{hasError:e,_hasValue:t,_value:s,thrownError:o,isStopped:r,_isComplete:l}=this;e?a.error(o):(r||l)&&(t&&a.next(s),a.complete())}next(a){this.isStopped||(this._value=a,this._hasValue=!0)}complete(){const{_hasValue:a,_value:e,_isComplete:t}=this;t||(this._isComplete=!0,a&&super.next(e),super.complete())}}var S=c(2664),T=c(2181);function b(i){return(0,T.h)((a,e)=>i<=e)}var D=c(8180);class N{constructor(){}loadScript(a,e,t,s=null){if(typeof document<"u"&&!document.getElementById(a)){let o=document.createElement("script");o.async=!0,o.src=e,o.onload=t,s||(s=document.head),s.appendChild(o)}}}class A{}const j={oneTapEnabled:!0};let p=(()=>{class i extends N{static#e=this.PROVIDER_ID="GOOGLE";constructor(e,t){super(),this.clientId=e,this.initOptions=t,this.changeUser=new n.vpe,this._socialUser=new R.X(null),this._accessToken=new R.X(null),this._receivedAccessToken=new n.vpe,this.initOptions={...j,...this.initOptions},this._socialUser.pipe(b(1)).subscribe(this.changeUser),this._accessToken.pipe(b(1)).subscribe(this._receivedAccessToken)}initialize(e){return new Promise((t,s)=>{try{this.loadScript(i.PROVIDER_ID,"https://accounts.google.com/gsi/client",()=>{if(google.accounts.id.initialize({client_id:this.clientId,auto_select:e,callback:({credential:o})=>{const r=this.createSocialUser(o);this._socialUser.next(r)},prompt_parent_id:this.initOptions?.prompt_parent_id,itp_support:this.initOptions.oneTapEnabled}),this.initOptions.oneTapEnabled&&this._socialUser.pipe((0,T.h)(o=>null===o)).subscribe(()=>google.accounts.id.prompt(console.debug)),this.initOptions.scopes){const o=this.initOptions.scopes instanceof Array?this.initOptions.scopes.filter(r=>r).join(" "):this.initOptions.scopes;this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.clientId,scope:o,prompt:this.initOptions.prompt,callback:r=>{r.error?this._accessToken.error({code:r.error,description:r.error_description,uri:r.error_uri}):this._accessToken.next(r.access_token)}})}t()})}catch(o){s(o)}})}getLoginStatus(){return new Promise((e,t)=>{this._socialUser.value?e(this._socialUser.value):t(`No user is currently logged in with ${i.PROVIDER_ID}`)})}refreshToken(){return new Promise((e,t)=>{google.accounts.id.revoke(this._socialUser.value.id,s=>{s.error?t(s.error):e(this._socialUser.value)})})}getAccessToken(){return new Promise((e,t)=>{this._tokenClient?(this._tokenClient.requestAccessToken({hint:this._socialUser.value?.email}),this._receivedAccessToken.pipe((0,D.q)(1)).subscribe(e)):t(this._socialUser.value?"No token client was instantiated, you should specify some scopes.":"You should be logged-in first.")})}revokeAccessToken(){return new Promise((e,t)=>{this._tokenClient?this._accessToken.value?google.accounts.oauth2.revoke(this._accessToken.value,()=>{this._accessToken.next(null),e()}):t("No access token to revoke"):t("No token client was instantiated, you should specify some scopes.")})}signIn(){return Promise.reject('You should not call this method directly for Google, use "<asl-google-signin-button>" wrapper or generate the button yourself with "google.accounts.id.renderButton()" (https://developers.google.com/identity/gsi/web/guides/display-button#javascript)')}signOut(){var e=this;return(0,O.Z)(function*(){google.accounts.id.disableAutoSelect(),e._socialUser.next(null)})()}createSocialUser(e){const t=new A;t.idToken=e;const s=this.decodeJwt(e);return t.id=s.sub,t.name=s.name,t.email=s.email,t.photoUrl=s.picture,t.firstName=s.given_name,t.lastName=s.family_name,t}decodeJwt(e){const s=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(window.atob(s).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(o)}}return i})(),f=(()=>{class i{static#e=this.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found";static#t=this.ERR_NOT_LOGGED_IN="Not logged in";static#s=this.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?";static#i=this.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token";static#o=this.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN="Chosen login provider is not supported for getting an access token";get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}constructor(e,t,s){this._ngZone=t,this._injector=s,this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new E(1),this.initialized=!1,this._initState=new L,e instanceof Promise?e.then(o=>{this.initialize(o)}):this.initialize(e)}initialize(e){this.autoLogin=void 0!==e.autoLogin&&e.autoLogin;const{onError:t=console.error}=e;e.providers.forEach(s=>{this.providers.set(s.id,"prototype"in s.provider?this._injector.get(s.provider):s.provider)}),Promise.all(Array.from(this.providers.values()).map(s=>s.initialize(this.autoLogin))).then(()=>{if(this.autoLogin){const s=[];let o=!1;this.providers.forEach((r,l)=>{const u=r.getLoginStatus();s.push(u),u.then(y=>{this.setUser(y,l),o=!0}).catch(console.debug)}),Promise.all(s).catch(()=>{o||(this._user=null,this._authState.next(null))})}this.providers.forEach((s,o)=>{(0,S.b)(s.changeUser)&&s.changeUser.subscribe(r=>{this._ngZone.run(()=>{this.setUser(r,o)})})})}).catch(s=>{t(s)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}getAccessToken(e){var t=this;return(0,O.Z)(function*(){const s=t.providers.get(e);if(!t.initialized)throw i.ERR_NOT_INITIALIZED;if(!s)throw i.ERR_LOGIN_PROVIDER_NOT_FOUND;if(!(s instanceof p))throw i.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN;return yield s.getAccessToken()})()}refreshAuthToken(e){return new Promise((t,s)=>{if(this.initialized){const o=this.providers.get(e);o?"function"!=typeof o.refreshToken?s(i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN):o.refreshToken().then(r=>{this.setUser(r,e),t()}).catch(r=>{s(r)}):s(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(i.ERR_NOT_INITIALIZED)})}refreshAccessToken(e){return new Promise((t,s)=>{if(this.initialized)if(e!==p.PROVIDER_ID)s(i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const o=this.providers.get(e);o instanceof p?o.revokeAccessToken().then(t).catch(s):s(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(i.ERR_NOT_INITIALIZED)})}signIn(e,t){return new Promise((s,o)=>{if(this.initialized){let r=this.providers.get(e);r?r.signIn(t).then(l=>{this.setUser(l,e),s(l)}).catch(l=>{o(l)}):o(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else o(i.ERR_NOT_INITIALIZED)})}signOut(e=!1){return new Promise((t,s)=>{if(this.initialized)if(this._user){let r=this.providers.get(this._user.provider);r?r.signOut(e).then(()=>{t(),this.setUser(null)}).catch(l=>{s(l)}):s(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(i.ERR_NOT_LOGGED_IN);else s(i.ERR_NOT_INITIALIZED)})}setUser(e,t){e&&t&&(e.provider=t),this._user=e,this._authState.next(e)}static#n=this.\u0275fac=function(t){return new(t||i)(n.LFG("SocialAuthServiceConfig"),n.LFG(n.R0b),n.LFG(n.zs3))};static#r=this.\u0275prov=n.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),C=(()=>{class i{static initialize(e){return{ngModule:i,providers:[f,{provide:"SocialAuthServiceConfig",useValue:e}]}}constructor(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}static#e=this.\u0275fac=function(t){return new(t||i)(n.LFG(i,12))};static#t=this.\u0275mod=n.oAB({type:i});static#s=this.\u0275inj=n.cJS({providers:[f],imports:[_.ez]})}return i})(),M=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=n.oAB({type:i});static#s=this.\u0275inj=n.cJS({})}return i})();var h=c(95);const x=[{path:"",component:(()=>{class i{constructor(e,t,s,o,r,l,u){this.router=e,this.toastr=t,this.jwtService=s,this.spinner=o,this.usersService=r,this.globalService=l,this.socialAuthService=u,this.loginObject=new P,this.currentUser=new d.ar}ngOnInit(){this.currentUser=this.jwtService.getCurrentUser(),this.currentUser&&this.router.navigate(["/dashboard"]);let e=this.jwtService.getCookie(m.N.cookieToken);e&&(this.loginObject=e)}doLogin(){let e=this.loginObject;e.remember?this.jwtService.setCookie(m.N.cookieToken,e):this.jwtService.deleteCookie(m.N.cookieToken);let t=Object.assign({},e);delete t.remember,this.spinner.show(),this.usersService.doSignIn(t).subscribe(s=>{if(this.spinner.hide(),200==s.status){let o=s.data;o.sesionStartTime=new Date,this.toastr.success(s.message,"Success"),this.jwtService.saveToken(o.authorization),this.jwtService.saveCurrentUser(JSON.stringify(o)),this.jwtService.getCurrentUser(),o&&o.role?(this.router.navigate(["/dashboard"]),this.globalService.sendActionChildToParent("")):this.router.navigate(["/login"])}else this.toastr.error(s.message,"Error")},s=>{this.spinner.hide(),this.globalService.sendActionChildToParent(""),this.toastr.error(s.message,"Error")})}static#e=this.\u0275fac=function(t){return new(t||i)(n.Y36(g.F0),n.Y36(w._W),n.Y36(d.Tj),n.Y36(k.t2),n.Y36(d.fz),n.Y36(d.Uh),n.Y36(f))};static#t=this.\u0275cmp=n.Xpm({type:i,selectors:[["app-login"]],decls:31,vars:3,consts:[[1,"row","pt-5"],[1,"col-xl-4","col-lg-5","col-md-12","d-flex","flex-column","card","m-auto"],[1,"card","card-plain"],[1,"sidenav-header","text-center","pt-4"],["aria-hidden","true","id","iconSidenav",1,"fas","fa-times","p-3","cursor-pointer","text-secondary","opacity-5","position-absolute","end-0","top-0","d-none","d-xl-none"],["href","dashboard.html","target","_blank",1,"navbar-brand","m-0"],["src","assets/img/logo-ct-dark.png","alt","main_logo",1,"navbar-brand-img","h-100"],[1,"ms-1","font-weight-bold"],[1,"card-header","pb-0","text-start"],[1,"font-weight-bolder"],[1,"mb-0"],[1,"card-body"],["role","form"],[1,"mb-3"],["required","","type","email","name","email","placeholder","Email","aria-label","Email",1,"form-control","form-control-lg",3,"ngModel","ngModelChange"],["required","","type","password","name","password","placeholder","Password","aria-label","Password",1,"form-control","form-control-lg",3,"ngModel","ngModelChange"],[1,"form-check","form-switch"],["name","remember","checked","","type","checkbox","id","rememberMe",1,"form-check-input",3,"ngModel","ngModelChange"],["for","rememberMe",1,"form-check-label"],[1,"row","pt-3"],[1,"col-md-12","d-flex","justify-content-center"],["type","button",1,"btn","btn-primary",2,"width","200px",3,"click"]],template:function(t,s){1&t&&(n._UZ(0,"br")(1,"br")(2,"br"),n.TgZ(3,"div",0)(4,"div",1)(5,"div",2)(6,"div",3),n._UZ(7,"i",4),n.TgZ(8,"a",5),n._UZ(9,"img",6),n.TgZ(10,"b",7),n._uU(11,"CATALYST ZOHO"),n.qZA()()(),n.TgZ(12,"div",8)(13,"h4",9),n._uU(14,"Sign In"),n.qZA(),n.TgZ(15,"p",10),n._uU(16,"Enter your email and password to sign in"),n.qZA()(),n.TgZ(17,"div",11)(18,"form",12)(19,"div",13)(20,"input",14),n.NdJ("ngModelChange",function(r){return s.loginObject.email=r}),n.qZA()(),n.TgZ(21,"div",13)(22,"input",15),n.NdJ("ngModelChange",function(r){return s.loginObject.password=r}),n.qZA()(),n.TgZ(23,"div",16)(24,"input",17),n.NdJ("ngModelChange",function(r){return s.loginObject.remember=r}),n.qZA(),n.TgZ(25,"label",18),n._uU(26,"Remember me"),n.qZA()(),n.TgZ(27,"div",19)(28,"div",20)(29,"button",21),n.NdJ("click",function(){return s.doLogin()}),n._uU(30," Sign in "),n.qZA()()()()()()()()),2&t&&(n.xp6(20),n.Q6J("ngModel",s.loginObject.email),n.xp6(2),n.Q6J("ngModel",s.loginObject.password),n.xp6(2),n.Q6J("ngModel",s.loginObject.remember))},dependencies:[h._Y,h.Fj,h.Wl,h.JJ,h.JL,h.Q7,h.On,h.F]})}return i})(),pathMatch:"full"}];let F=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=n.oAB({type:i});static#s=this.\u0275inj=n.cJS({imports:[g.Bz.forChild(x),g.Bz]})}return i})();const V={oneTapEnabled:!1};let B=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=n.oAB({type:i});static#s=this.\u0275inj=n.cJS({providers:[{provide:"SocialAuthServiceConfig",useValue:{autoLogin:!1,providers:[{id:p.PROVIDER_ID,provider:new p("1051803384347-91967jipju1ume5ul4dcr5g84bfaja56.apps.googleusercontent.com",V)}],onError:e=>{console.error(e)}}}],imports:[_.ez,g.Bz,d.eY,C,F,M]})}return i})()}}]);